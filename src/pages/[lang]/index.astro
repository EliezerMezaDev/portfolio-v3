---
import esTranslations from "@/content/i18n/es.json";
import enTranslations from "@/content/i18n/en.json";

import { getCollection } from "astro:content";

import Layout from "@/layouts/Layout.astro";

//? sections
import Hero from "@/components/Hero.astro";
import ProjectsPreview from "@/components/projects/ProjectsPreview.astro";
import Skills from "@/components/skills/Skills.astro";
import Experience from "@/components/experience/Experience.astro";

const { lang } = Astro.params;

if (lang !== "es" && lang !== "en") {
  return new Response(null, { status: 404, statusText: "Not Found" });
}

const featuredProjects = await getCollection("projects", ({ id, data }) => {
  return id.startsWith(`${lang}/`) && data.isFeatured === true;
});

const t = lang === "es" ? esTranslations : enTranslations;
---

<Layout t={t} lang={lang} showFooter={true}>
  <Hero t={t} />

  <ProjectsPreview projects={featuredProjects} t={t} lang={lang} />

  <Experience lang={lang} t={t} />

  <Skills t={t} />
</Layout>
